## 一条SQL语句是如何执行的
SQL的执行流程从数据库收到SQL到数据库返回数据结束。

假设客户端已经和数据库建立连接（通过auth）。
1. 查询缓存
   数据库先尝试在缓存中查询query
2. 分析器进行词法分析和句法分析
3. 优化器生成query plan, 并选择index
4. 执行SQL
   * 进行authz检验，判断是否有执行权限
   * 调用存储引擎接口提取数据

## 事务
事务（transaction）是一组操作逻辑，在更大细粒度上去对数据库内容进行更新。数据库也可以以transaction为单位去更新。

1. 事务的ACID特性，
 * 原子性：一个事务要么都发生，要么都不发生。
 * 一致性：事务不能破坏数据的完整性，如果产生了破坏要有能力返回到破坏前的状态。
 * 隔离性：多个并发事务之间不能互相干扰，事务间的数据要有隔离
 * 持久性：事务一旦“提交”，就被认为对数据库产生了永久更新，不能因为非主观的因素而改变。

2. 事务的并发问题
 * 脏读（dirty read）：一个事务读到了另一个事务未提交的数据。
 * 不可重复读：一个事务读到了另一个事务已经提交的数据，引起事务中多次查询的不一致
 * 虚读/幻读：
 * 事务的更新丢失：一个事务读到了事务没有更新完的数据

3. 隔离级别
 * read uncommitted, read committed, repeatable read, serializable

4. 一般来说，隔离级别越严格的意味着安全性越高，因为更高的事务隔离级别意味着事务的并发性更弱，性能更差。
